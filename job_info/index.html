<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"><style>
    .collapsible {background-color:lightblue;color:white;cursor:pointer;padding:18px;width:100%;border:none;text-align:left;font-family: times new roman;font-size: 16px;font-weight:bold;}
    .active, .collapsible:hover {background-color:#3E9FB0;}
    .content {padding: 0 18px;display: none;overflow: hidden;background-color: #f1f1f1;}
    th {background-color:lightblue;color:white;border-collapse: collapse;}
    th, td {padding: 10px;}
    </style></head><body>
    <div style="background-color:lightblue;color:darkgrey;padding:1px;text-align:center;background-image: url('css/pexels-photo-355423.jpeg');background-size: cover;background-position: center;">
    <img src='css/logo.png' alt='logo'><h4>JOB INFO v17</h4></div>
    <input id="openFileDialog" type="file" name="name" style="display: none;" />
    
    <button class="collapsible">JOB DETAILS</button><div class="content">
    <p></p>
    <table id="tbl_job" style="width: 100%;text-align:left" align="left" valign:"top">
    <tr><td width="10%" align="left">Job Name:</td><td width="30%" align="left"><input id="textJobName" type="text" value="EDWPDF0E" style="width: 100%;text-align:left"></input></td><td width="5%" align="left"><button onclick='RunExe("SearchJobName"); return false;'>Search</button></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="40%" align="left" style="color:red" id="errorJobName"></td></tr>
    <tr><td width="10%" align="left">Package:</td><td width="30%" align="left"><input id="textPackage" type="text" value="" style="width: 100%;text-align:left"></input></td><td width="5%" align="left"><button onclick='RunExe("SearchPackage"); return false;'>Search</button></td><td width="5%" align="left"><button onclick='RunExe("OpenPackage"); return false;'>Open</button></td><td width="5%" align="left"><button onclick='RunExe("OpenPackageFolder"); return false;'>Folder</button></td><td width="5%" align="left"><button onclick='RunExe("CopyPackage"); return false;'>Copy</button></td><td width="40%" align="left" style="color:red" id="errorPackage"></td></tr>
    <tr><td width="10%" align="left">Bat File:</td><td width="30%" align="left"><input id="textBatFile" type="text" value="" style="width: 100%;text-align:left"></input></td><td width="5%" align="left"><button onclick='RunExe("SearchBatFile"); return false;'>Search</button></td><td width="5%" align="left"><button onclick='RunExe("OpenBatFile"); return false;'>Open</button></td><td width="5%" align="left"><button onclick='RunExe("OpenBatFileFolder"); return false;'>Folder</button></td><td width="5%" align="left"><button onclick='RunExe("CopyBatFile"); return false;'>Copy</button></td><td width="40%" align="left" style="color:red" id="errorBatFile"></td></tr>
    <tr><td width="10%" align="left">Input File:</td><td width="30%" align="left"><input id="textInputFile" type="text" style="width: 100%;text-align:left"></input></td><td width="5%" align="left"><button hidden=true onclick='RunExe("CheckIncident"); return false;'>Search</button></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="40%" align="left" style="color:red" id="errorInputFile"></td></tr>
    <tr><td width="10%" align="left"></td><td width="30%" align="left"></td><td width="5%" align="left"><button onclick='RunExe("FileSubmit"); return false;'>Submit</button></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="5%" align="left"></td><td width="40%" align="left" style="color:red"></td></tr>
    </table>
    <p></p>
    </div>
    
    <button class="collapsible">SEND MAIL</button><div class="content">
    <p></p>
    <table id="tbl_job" style="width: 100%;text-align:left" align="left" valign:"top">
    <tr><td width="10%" align="left">Incident:</td><td width="30%" align="left"><input id="textIncident" type="text" style="width: 100%;text-align:left"></input></td><td width="5%" align="left"><button hidden=true onclick='RunExe("CheckIncident"); return false;'>Search</button></td><td width="55%" align="left" style="color:red" id="errorIncident"></td></tr>
    <tr><td width="10%" align="left"></td><td width="30%" align="left"></td><td width="5%" align="left"><button onclick='RunExe("FileSubmit"); return false;'>Submit</button></td><td width="55%" align="left" style="color:red"></td></tr>
    </table>
    <p></p>
    </div>
    
    <button class="collapsible">OUTPUT LOG</button><div class="content">
    <p></p>
    <textarea id="textarea" name="textarea" style="width: 100%;text-align:left" align="center" valign:"top" rows="14" cols="150"></textarea>
    <p></p>
    </div>
    
        <script type="text/javascript">
    var jobdatalist = "./data/Convert Control M xml to CA7 Bat list.txt";
    var lines;
    
    function RunExe(index){
      switch(index) {
      case "SearchJobName": SearchJobName(); break;
      case "SearchPackage": SearchPackage(); break;
      case "SearchBatFile": SearchBatFile(); break;
      case "OpenPackage": OpenPackage(); break;
      case "OpenPackageFolder": OpenPackageFolder(); break;
      case "CopyPackage": CopyPackage(); break;
      case "OpenBatFile": OpenBatFile(); break;
      case "OpenBatFileFolder": OpenBatFileFolder(); break;
      case "CopyBatFile": CopyBatFile(); break;
      }
    }
            
    function CopyBatFile() {
        var textBatFile = document.getElementById('textBatFile');
        window.clipboardData.setData ("Text", textBatFile.value);
    }
            
    function SearchJobName(){
      var textJobName = document.getElementById('textJobName');
      var sTextJobName = textJobName.value;
      sTextJobName = sTextJobName.toUpperCase();
      textJobName.value = sTextJobName;
      var textPackage = document.getElementById('textPackage');
      textPackage.value = "";
      var textBatFile = document.getElementById('textBatFile');
      textBatFile.value = "";
      document.getElementById('textarea').value = "";
      var textInputFile = document.getElementById('textInputFile');
      textInputFile.value = "";
      
      var textErrorJobName = document.getElementById('errorJobName');
      textErrorJobName.innerHTML = "";
      var textErrorPackage = document.getElementById('errorPackage');
      textErrorPackage.innerHTML = "";
      var textErrorBatFile = document.getElementById('errorBatFile');
      textErrorBatFile.innerHTML = "";
      var textErrorInputFile = document.getElementById('errorInputFile');
      textErrorInputFile.innerHTML = "";
      
      sFileNameFrom = "";
      sFileNameCopy = "";
      sPackageNameList = "";
      sFileOutgoingList = "";
    
      var txtFile = new XMLHttpRequest();
      txtFile.open("GET", jobdatalist, true);
      txtFile.onreadystatechange = function() {
          if (txtFile.readyState === 4) {  // Makes sure the document is ready to parse.
            if (txtFile.status === 200) {  // Makes sure it's found the file.
                //allText = txtFile.responseText;
                lines = txtFile.responseText.split("\n"); // Will separate each line into an array
                var sResult = "";
                for (i = 0; i < lines.length; i++) {
                    if (lines[i]!="") {
                        if (lines[i].substring(0, sTextJobName.length)==sTextJobName) {
                            sResult = lines[i];
                            break;
                        }
                    }
                }
                if (sResult=="") {
                    textErrorPackage.innerHTML = "Not Found";
                } else {
                    var aResult = sResult.split(";");
                    if (aResult[0].length!=0) {
                        textJobName.value = aResult[0];
                    }
                    if (aResult[1].length!=0) {
                        textPackage.value = aResult[1];
                    }
                    if (aResult[2].length!=0) {
                        textBatFile.value = aResult[2];
                    }
                    if (aResult[3].length!=0) {
                        textBatFile.value = aResult[2];
                        //  S000013845 WINSCHED EDW EDWPDF0E OUTPUT.LOG
                        //readTextFile("file:///C:/your/path/to/file.txt");
                        //readTextFile("file://///S000013845/WINSCHED/EDW/EDWPDF0E/OUTPUT.LOG");
                    }
                    //document.getElementById('textarea').value += sTextJobName+"\n"; document.getElementById('textarea').scrollTop = document.getElementById('textarea').scrollHeight;
                    document.getElementById('textarea').value += sResult+"\n"; document.getElementById('textarea').scrollTop = document.getElementById('textarea').scrollHeight;
                }
            }
          }
      }
      txtFile.send(null);
    }
            
    function OpenBatFileFolder(){
      var textErrorBatFile = document.getElementById('errorBatFile');
      textErrorBatFile.innerHTML = "";
      var textBatFile = document.getElementById('textBatFile');
      if(textBatFile.value!=''){
        var rawFile = new XMLHttpRequest();
        rawFile.open("GET", GetFolderName(textBatFile.value), true);
        //shell.run(GetFolderName(textBatFile.value),1,true);
      } else {
        textErrorBatFile.innerHTML = "BatFile is empty";
      }
    }
            
    function GetFolderName(sFileName){
      var lastChar = strReverse(sFileName).indexOf("\\");
      return sFileName.substr(0, sFileName.length - lastChar);
    }
            
    function readTextFile(file) {
        var rawFile = new XMLHttpRequest();
        //rawFile.open("GET", file, false);
        rawFile.open("GET", file, true);
        rawFile.onreadystatechange = function () {
            if(rawFile.readyState === 4) {
                if(rawFile.status === 200 || rawFile.status == 0) {
                    //var allText = rawFile.responseText;
                    //alert(allText);
                    lines = rawFile.responseText.split("\n"); // Will separate each line into an array
                    document.getElementById('textarea').value += lines[0]+"\n"; document.getElementById('textarea').scrollTop = document.getElementById('textarea').scrollHeight;
                }
            }
        }
        rawFile.send(null);
    }            
            
    function strReverse(str) {
        var strNew="";
        for (istr = 0; istr < str.length; istr++) {
            strNew = str.substr(istr,1) + strNew;
        }
        return strNew;
    }
            
    function main() {
        var coll = document.getElementsByClassName("collapsible"); var k;
        for (k = 0; k < coll.length; k++) {
            coll[k].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {content.style.display = "none";} else {content.style.display = "block";}
            });
        }    
    }
    
    main();
    
        </script>

    <div style='background-color:lightblue;color:white;padding:1px;text-align:right;font-weight:bold'>
    <p>ACTIONS <button onclick='a98.click()'><a id='a98' hidden=true href='C:\Users\e38536\Documents\Misc\vbscript\Reminder.vbs'></a>Reminder</button>
               <button onclick='a99.click()'><a id='a99' hidden=true href='C:\html\Options.html'></a>Options</button></p></div>
    
    
        </body>
    
    </html>
    
